/*! smart 2014-09-02 */
!function(a){var b={},c=a.st={conf:function(a,c){return void 0===c?b[a]:void(b[a]=c)}};return a.stDefine=function(b,d){var e=d(c);e&&$.extend(c,e),a.define&&define(b,function(){return e})},c}(window),stDefine("util",function(){"use strict";function a(a,b){return Array.prototype.slice.call(a,b||0)}function b(a){return $.isPlainObject(a)}function c(a,b){return"boolean"!=typeof a&&(b=a,a=!1),$.extend(a,{},b)}function d(a,b,c,d,f){if(a||b){var g=a[b];a[b]=d?e(c,g,f):e(g,c,f)}}function e(a,b,c){return b?a?function(){var d,e=this,f=arguments;return d=a.apply(e,f),c&&d===!1?d:b.apply(e,f)}:b:a}function f(a,c,d,e,g){var h;return $.each(d,function(d,i){if(!g||g(e+d)!==!1){var j=e+d+".";null!=i&&(null==(h=c[d])?(a&&($.isArray(i)?i=[].concat(i):b(i)&&(i=f(a,{},i,j,g))),c[d]=i):a&&b(h)&&b(i)&&f(a,h,i,j,g))}}),c}function g(a,b,c,d){var e;return"boolean"!=typeof a&&(d=c,c=b,b=a,a=!1),null==c||$.isEmptyObject(c)?b:(d&&("function"==typeof d?e=d:d.length&&(e=function(a){return-1===d.indexOf(a)})),f(a,b||{},c,"",e))}function h(a,b,c,d){var e,f,g,h;if(!a)return null;for(b=b.split("."),f=c?1:0,h=b.length;h>f;f++)if((g=b[f])&&(e=d(f,g,h),void 0!==e))return e;return e}function i(a,b,c){var d,e=a;return d=h(a,b,c,function(a,b){return e=e[b],e?void 0:null}),null===d?d:e}function j(a,c,d,e,f){var i,j,k,l=a;return"boolean"==typeof e&&(i=e,f=e,e=i),k=h(a,c,f,function(a,c,f){j=l[c],a===f-1?e&&b(j)?"merge"===e?g(!0,j,d):$.extend(!0,j,d):l[c]=d:l=b(j)?j:l[c]={}}),null===k?k:l}function k(a,b){function c(a){return i?a:a.target}function d(a,b){var c=j.length;if(i&&(b=a.priority),null==b&&(b=k),i||(a={target:a,priority:b}),b>g)g=b,j.unshift(a),c||(h=b);else if(h>=b)j.push(a),h=b,c||(g=b);else{for(var d=1;c>d&&!(j[d].priority<b);d++);d>c&&(h=b),j.splice(d,0,a)}return this}function e(a){var b=typeof a;if("function"===b)for(var d,e,f=0;(e=j[f])&&(d=a(c(e),f,j),"break"!==d)&&(!d||(j.splice(f,1),f--,"done"!==d));f++);else"number"===b&&j.splice(f,1);return this}function f(a,b){var d,e,f;if(0===j.length)return this;for("function"==typeof a&&(b=a,a=!1),a?(d=j.length-1,e=-1):(d=0,e=1);(f=j[d])&&b(c(f),d,j)!==!1;d+=e);return this}var g=0,h=0,i="self"===a,j=[],k=b||0;return{add:d,remove:e,each:f,at:function(a){var b=j[a];return b&&c(b)},clear:function(){return j=[],g=h=0,this},len:function(){return j.length}}}var l={sliceArgs:a,copy:c,injectFn:d,mergeFn:e,mergeObj:g,getObj:i,setObj:j,priorityList:k};return l}),stDefine("aop",function(a){"use strict";function b(a){return void 0!==a}function c(a){this.mode=a}function d(a){$.extend(this,a),this.promise=function(a){return new c(a)}}function e(a){return new d(a)}function f(a){return a?a instanceof c:!1}function g(a){return a&&"object"==typeof a?a instanceof d:!1}function h(a,b){return b&&setTimeout(function(){a.reject(b)},0),a.promise()}function i(c){function d(a){return n.indexOf(a)>-1}function g(){return r.clear(),this}function i(a,b,c,d){return a||"string"==typeof a||b?(r.add({name:a,fn:b,priority:c,mode:d}),this):void 0}function j(a){return r.remove(function(b){return b.name===a}),this}function k(a,c,d){function i(){q&&g(),w=!0,n&&n.resolve(s)}function j(a){t=a,n&&n.reject(a)}function k(){var d;b(s)&&(u.result=s),z>x?(m=r.at(x++))&&("once"===m.mode&&u.remove(),d=m.fn.apply(a,c),f(d)?p?k():"noBlock"===d.mode&&(l=!0,k()):u.resolve(d)):(!l&&!p||y===z)&&i()}var l,m,n,s,t,u,v,w,x=0,y=0,z=r.len();if(z)return"function"!=typeof d&&(d=null),u=e({stopPropagation:function(){return v=!0,this},resolve:function(a){y++,b(a)&&(s=a),v?i():k()},reject:function(a){j(a)},remove:function(){return r.remove(--x),z--,this}}),o||(c=c?[u].concat(c):[u],d&&d(u)),k(),w?s:(n=$.Deferred(),h(n,t))}function l(a){var b=!1;return r.each(function(c){return c.name===a?(b=!0,!1):void 0}),b}var n,o,p,q,r=a.priorityList("self",a.conf("aop-Priority"));return c&&(n=c.split(" "),q=d("once"),o=d("callback"),p=d("noBlock"),n=null),{add:i,has:l,remove:j,fire:function(){return k(null,m(arguments))},fireWith:k,clear:g}}function j(c,d,e){function j(a,b){var c=t[a];return!c&&b&&(c=t[a]={}),c}function l(a,b,c){var d,e=j(a,c);return b||(b="after"),e&&(d=e[b],!d&&c&&(d=e[b]=i(b===o[3]?"callback":s))),d}function n(a,b,c){var d=l(a,b);d&&(c?$.isArray(c)?$.each(c,function(a,b){d.remove(b)}):d.remove(c):d.clear())}function q(c,d,e){var i,j,k,n,q,s,t,w,x,y=arguments,z=y.length,A=u[c],B=c,C=e,D=3;if(!(D>z)&&"string"==typeof c&&"string"==typeof d&&"function"==typeof e){if(z>D){for(;z>D;D++)s=y[D],t=typeof s,"boolean"===t&&(i=s),"number"===t?j=s:"string"===t&&(o.indexOf(s)>-1?i=s:k=s);n=i===o[2]}if(!A){if(A=u[B]=a.getObj(v,B),!A)return;if(x="function"!=typeof A){if(n||!p)return;A=function(a){return u[B]=a}}if(w=function(){function c(){w=!0,s&&E&&(s.resolve=E),y&&y.resolve(q)}function d(a){t=a,y&&y.reject(a),r(B,[a].concat(G),null,o[3])}function e(a){b(a)&&(q=a)}function i(a,b){$.when(a).then(function(a){b(a)},d)}function j(){return D=!0,this}function k(){return D=C=!0,this}function l(c){b(q)&&(c.result=q),c.preventDefault=j,c.stop=a.mergeFn(c.stopPropagation,k),s&&s.__mergePArg&&s.__mergePArg(c)}function n(a){if(x){if(b(q))return[q,F];a.push(F)}return a}function p(){return C?void c():void i(r.call(v,B,n(z),l),function(a){e(a),c()})}var q,s,t,w,y,z,C,D,E,F,G=z=m(arguments);return x&&(F=u[B]),G.length&&g(G[0])&&(s=G[0],E=s.resolve,s.resolve=function(a){s.resolve=E,E=null,e(a),p()},z=[].concat(G),z.shift()),i(r.call(v,B,n(z),l,o[0]),function(a){return e(a),D?void p():(s&&b(q)&&(s.result=q),void i(A.apply(v,n(G)),function(a){s&&f(a)||(e(a),p())}))}),w?q:(y=$.Deferred(),h(y,t))},x){var E=c.lastIndexOf("."),F=E>0?c.substring(E+1):c,G=E>0?a.getObj(v,c.substring(0,E)):v;p(G,F,{get:function(){return u[c]},set:w})}else v[B]=w}return n?(q=v[B],v[B]=function(){var a=m(arguments);a.unshift(q),C.apply(self,a)}):l(B,i,!0).add(d,C,j,k),v}}function r(a,b,c,d){var e=l(a,d);return e?e.fireWith(this,b,c):void 0}if(c||"object"==typeof c){var s,t={},u={},v=c;"object"==typeof d?e=d:s=d;var w={onHandler:function(a,b,c,d,e){return l(a,null,!0).add(b,c,d,e),this},fireHandler:function(a,b){return r(a,b)},on:function(a,b,c,d,e){return q(a,b,c,o[1],d,e)},onBefore:function(a,b,c,d,e){return q(a,b,c,o[0],d,e)},onRound:function(a,b,c){return q(a,b,c,o[2])},onError:function(a,b,c,d){return q(a,b,c,o[3],d)},off:function(a,b){return n(a,o[1],b),v},offBefore:function(a,b){return n(a,o[0],b),v},extend:function(a){var b;return $.each(a,function(a){((b=u[a])?u:v)[name]=b}),v}};return k(c,e,w),c}}function k(a,b,c){var d;b=b?$.extend({},n,b):n,$.each(b,function(b,e){e&&(d=c[b])&&(a[e]=d)})}function l(c){function d(c,d){function j(a,b){return s=r&&b!==!1?a?[r].concat(a):[r]:a}function k(){p=!0,v&&v.resolve(q)}function m(a){w=a,v&&v.reject(a)}function n(){var a,c,d;if(u)return void k();if(x){var a=i.indexOf(x);a>-1&&(y=a)}else x=i[++y];return b(q)&&(r.result=q),x&&(c=g[x])?(d=o||s,x=o=null,$.when(c.apply(g,d)).then(function(a){f(a)||(b(a)&&(q=a),n())},m),void 0):void k()}var o,p,q,r,s,t,u,v,w,x=c,y=-1;return"simple"!==l&&(r=e({end:function(){return u=!0,this},resolve:function(a){b(a)&&(q=a),u?k():n()},reject:function(a){m(a)},next:function(a,b,c){return x=a,"number"!=typeof b?c=b:y+=b,c&&(o=[r].concat(c)),this},changeArgs:j,recoverArgs:function(){return s=t,this},__mergePArg:function(b){a.mergeObj(b,r),b.end=a.mergeFn(b.stop,b.end)}})),t=j(d),n(),p?q:(v=$.Deferred(),h(v,w))}var g,i,k,l;if(c)return g=c.flow,i=c.order,k=c.trigger,l=c.mode,k&&j(g,k.mode,k.iFace),g.boot=function(){return d(null,m(arguments))},g.bootWithStart=d,g}var m=a.sliceArgs;a.conf("aop-Priority",0);var n={onHandler:"onHandler",fireHandler:"fireHandler",on:"on",onBefore:"onBefore",onRound:"onRound",onError:"onError",off:"off",offBefore:"offBefore",extend:"extend"},o=["before","after","round","error"],p=Object.defineProperty;return{promiseEvent:i,attachTrigger:j,flowController:l}}),stDefine("oop",function(a){"use strict";function b(a,b,c,f){var g,h,i=b,j=[a],k=function(){var a=this,b=arguments,c=b.length;return a instanceof k?(a._$indicator={},a._$fn=h,d.fireWith(a,f),void(a.klassInit&&a.klassInit.apply(a,b))):0===c?new k:4>c?new k(b[0],b[1],b[2]):7>c?new k(b[0],b[1],b[2],b[3],b[4],b[5]):new k(b[0],b[1],b[2],b[3],b[4],b[5],b[6],b[7],b[8])};return c?(g=c.prototype||c,h=k.prototype=Object.create(g),h._$super=g,h.constructor=c,g._$inheirts?j=j.concat(g._$inheirts):j.push(c.name)):h=$.extend(k.prototype,e),k.fn=h,$.extend(h,i,{_$klass:!0,_$kName:a,_$inheirts:j}),k}function c(c,d,e,f){function g(c,d,e){return e=e?i(e)||v:v,q?a.mergeObj(!0,d,e):(d=b(c,d,e),r?d:new d)}function h(a,b,c){return u[a]=g(a,b,c)}function i(a,b){var c;return 0===arguments.length?t:a&&(c=u[a])?(c._itemType=f,c):b?t:null}function j(a){return t=get(a,!0),this}function k(a){delete u[a]}var l,m,n,o,p,q,r,s,t,u={},v=d,w=arguments,x=w.length,y=2;if(1===x&&"object"==typeof c)v=c.base,l=c.proto,m=c.type,n=c.initDefault,c=c.name;else if(x>y)for(;x>y;y++)(p=w[y])&&(o=typeof p,"object"===o?l=p:"string"===o?m=p:"boolean"===o&&(n=p));return"merge"===m?q=!0:"class"===m?r=!0:s=!0,q||(v=b(c+"_base",v)),n&&(t=s?new v:v),e=$.extend({build:g,add:h,find:i,remove:k,setDefault:j,fire:function(a,b){var c;$.each(u,function(d,e){e&&(c=e[a])&&c.apply(null,b)})}},l),b(c,e,null,{trigger:!0})()}var d=a.promiseEvent(),e={callProto:function(a,b){var c=this._$fn[a];return c?c.apply(this,b):void 0},getBase:function(a){var b=this,c=b._$super;if(a&&"number"==typeof a&&(a=b._$inheirts[a]),c)if(a)for(;c&&c._$kName!=a;)c=c._$super;else if(c._$kName==b._$kName)return null;return c},callBase:function(a,b,c){var d,e,f,g=this,h=g._$super,i=g._$indicator;if(h)return arguments.length<3&&(c=b,b=null),b?h=g.getBase(b):(f=i[a])&&(h=f._$super||f.fn._$super||f),h&&(d=h[a])&&(i[a]=h,e=d.apply(this,c),i[a]=null),e},extend:function(a){return $.extend(this,a),this}};return a.conf("oop-KlassBase",e),{klass:b,onKlassInit:d,factory:c}}),stDefine("filterBuilder",function(a){function b(a){if(a)switch(typeof a){case"string":this._conditions=d(a);break;case"function":this._filter=a;break;case"object":this._params=a}}function c(a){return function(b){var c=!0;return $.each(a,function(a,d){return b[a]!==d?c=!1:void 0}),c}}function d(a){var b=[],c=0,d=[b];return a.split("(").forEach(function(a,b){0===b?e(d,c,a):a.split(")").forEach(function(a,b){b>0?c--:c++,e(d,c,a)})}),b.length?b:null}function e(a,b,c){var d,e,g,h=a.length-1;e=c.split(/\s(or|and)\s/g),0===e[0].length&&n.indexOf(e[1])>-1&&(e.shift(),a[h].or=e.shift()===n[1]),b>h?d=a[b]=[]:(d=a[b],h>b&&d.push(a.pop())),e.forEach(function(a){a&&(n.indexOf(a)>-1?g.or=a===n[1]:(g=f(a),d.push(g)))})}function f(a){var b,c,d=!1;return a.charAt(0)===m[0]&&(c=a.lastIndexOf(m[1]),c>1?(a=a.substring(1,c),d=!0):a=a.substring(1)),b=a.split(" ").filter(function(a){return a.length>0}),{ignoreNull:d,field:b[0],operation:b[1],param:b[2]}}function g(b,c){var d,e,f,h,i,j,k=b.length-1,l=[],m=[l];return b.forEach(function(b,n){return i?(i=!1,void(f=b.or)):(h=b.or,o(b)?d=g(b,c):(param=b.param,"@"===param.charAt(0)&&(param=a.getObj(c,param.substr(1))),b.ignoreNull&&null==param?(h&&(i=!0),d=null):d={field:b.field,operation:b.operation,param:param}),d&&(n===k?h&&(l=m[0]):n>0&&!f!=!h&&(h?m.length>1?(l=m[0],m=[l]):m[0]=l=[{and:l}]:(j=[],m.push(j),l.push({and:j}),l=j)),l.push(d)),h&&(e=!0),void(f=h))}),l=m[0],l.length?e?{or:l}:{and:l}:void 0}function h(a){return function(b){var c=!0;return $.each(a,function(a,d){i(b,d,"or"===a)||(c=!1)}),c}}function i(a,b,c){var d,e;return b.some(function(b){return b.field?e=l(a,b):(d=b.or)?e=i(a,d,!0):(d=b.and)&&(e=i(a,d,!1)),c&&e?!0:c||e?void 0:!0}),e}function j(a,b){return b&&a&&a.length&&a.indexOf?a.indexOf(String(b))>-1:!1}function k(a,b,c){return b&&a&&a.length&&a.substr?(b=String(b),(c?a.substr(a.length-b.length):a.substr(0,b.length))===b):!1}function l(b,c){var d,e,f,g=c.operation;return"!"===g.charAt(0)&&(e=1,g=g.substring(1)),f=(d=p[g])?d(a.getObj(b,c.field),c.param):!1,e?!f:f}var m=["{","}"],n=["and","or"],o=$.isArray;b.prototype={buildCondition:function(a){return this._conditions?g(this._conditions,a):void 0},buildFn:function(d,e){var f,g,i,j=this;return j._filter?g=j._filter:j._conditions?(f=this.buildCondition(d),f&&(g=h(f))):e||(g=c(a.mergeObj(d,j._params))),e&&(filterType=typeof e,"string"===filterType?i=new b(e).buildFn(d):"function"===filterType&&(i=e)),a.mergeFn(g,i)}};var p={"=":function(a,b){return a===b},"<":function(a,b){return b>a},"<=":function(a,b){return b>=a},">":function(a,b){return a>b},">=":function(a,b){return a>=b},"in":function(a,b){return j(b,a)},like:j,startOf:k,endOf:function(a,b){return k(a,b,!0)}};return{filterBuilder:function(a){return new b(a)},extendOperation:function(a,b){p[a]=b}}}),stDefine("dataManager",function(a){function b(b){b._Flow=a.flowController({flow:{buildGetPolicy:function(a,b,c,d){b.buildPolicy(d,c.get)},getData:function(a,b,c,d){var f=i(b,d);return a.__getDone=!0,a.next(e(b,f,d)?"getFromDs":"getFromDm"),f},getFromDm:function(a,b,c,d){var e=a.__getDone?a.result:i(b,d);return d.update||a.end(),e},getFromDs:function(a,b,c,d){var e,f=j(d,c);return f?(e=function(c){d.update!==!1?b.set(h(b,c,d,function(b){a.end().resolve(b)},a.reject)):a.end().resolve(c)},k("search",f,b,d,e,a.reject),a.promise()):void a.end().resolve(i(b,d))},setData:function(a,b,c,d){b.buildPolicy(d,c.set),a.next("ds"===d.way?"setToDs":"setToDm")},setToDm:function(a,b,c,d){return"dm"!==d.way&&a.next("setToDs"),b._innerUpdate(d)},setToDs:function(a,b,c,d){var e,f,g=j(d,c),h=d.pending!==!1;return g&&(h?(e=a.resolve,f=a.reject):a.resolve(data),k("update",g,b,d,e,f),h)?a.promise():void 0}},order:["buildGetPolicy","getData","setData"],trigger:!0})}function c(a,b,c){b&&(a.initPolicy(b,c),!b.get||"get"!==c&&"trigger"!==c||a.initPolicy(b.get,"set"))}function d(a,b){b||(b={});var c=b.success,d=b.error;return b.success=null,b.error=null,{policy:b,success:c,error:d}}function e(a,b,c){return(a.op.checkEmpty||a.checkEmpty)(b,c)}function f(a,b,c){var d=$.Deferred();return $.when(a).done(function(a){b&&b(a),d.resolve(a)}).fail(function(a){c&&c(a),d.resolve(a)}),d.promise()}function g(b,c,d){if(!c._$builded){var e,f,g=c.params;if(s(g)&&(g=c.params=g.apply(null,[b,c])),d&&c.mergeFilter!==!1&&(e=d.params,s(e)&&(e=e.apply(null,[b,c])),g?(f=typeof g,f===typeof e&&"object"===f&&a.mergeObj(g,e)):c.params=e),b._filterMode){var h=d&&d._filterBuilder||r;c.filter=h.buildFn(c.params,c.filter)}c._$builded=!0}}function h(a,b,c,d,e){var f={data:b,filter:c.filter,params:c.params,way:"dm",pending:!1,success:d,error:e};return c.set?(a.buildPolicy(c.set,f),c.set):f}function i(a,b){return a._innerSearch(b)}function j(){for(var a,b=arguments,c=b.length,d=0;c>d;d++)if((arg=b[d])&&(a=arg.dataServices))return a}function k(a,b,c,d,f,g){function h(a){var b=$.extend(!0,{},a,d);return b.success=f,b.error=g,c.setDataSerive(b),b}var i,j,k=0;$.isArray(b)?(j=function(){(i=b[k++])?(i=h(i),i.success=function(a){e(c,a,d)?j():f(a)},p.operate(a,i)):f(data)})():p.operate(a,h(b))}function l(a,b,c,d){if(!b)return c;var e=d.__timers;return __timers||(e=d.__timers={},d.stopTimer=function(a){var b,c=this.__timers;$.isEmptyObject(c)||(a?(b=c[a])&&(c[a]=null,clearInterval(b)):($.each(c,function(a,b){b&&clearInterval(b)}),this.__timers={}))}),function(){e[a]=setInterval(c,b)}}function m(a,b,e,h){var i,j,b=d(e,b),k=b.policy,m=k.def,n=(k.set,k.position),o=k.delay||0,p=k.timer,q=k.userfulLife;c(e,k,"trigger"),i=k.def?"buildGetPolicy":"get"===n?"getData":"dm"===n?"getFromDm":"getFromDs",q&&("once"===q?j=function(){return!0}:s(q)&&(j=q)),h.on(i,"trigger",function(c,d,e,h,i){var j,n;if(!i){if(m)return void d.buildPolicy(h,k);n=$.extend({mergeFilter:!1,way:"ds"},k),g(d,n,h),j=function(){f(d._Flow.bootWithStart("getData",[d,d.op,n,!0]),b.success,b.error).always(function(a){d.fireHandler("trigger",[a,n])})},setTimeout(l(a,p,j,d),o)}})}var n,o,p,q={ignoreMerges:["params","filter","_filterBuilder"],dmOp:{set:{},get:{}}},r=a.filterBuilder(),s=(a.promiseEvent,$.isFunction);return p=a.factory({name:"dataServices",proto:{operate:function(a,b){var c=this.find(b.dsType);if(c)return"initOptions"!==a&&c.initOptions(b),c[a](b);throw b.dsType+",not defined in dataServices!"},search:function(a){return this.operate("search",a)},update:function(a){return this.operate("update",a)}},base:{search:function(){},update:function(){},initOptions:function(){}}}),n=a.factory({name:"dataManager",type:"class",proto:{create:function(a,b){var c=this.find(a);return c?new c(b):void console.log(a+",not defined in dataManager")}},base:{_filterMode:!0,klassInit:function(d){var e=a.attachTrigger(this);d=e.op=a.mergeObj(d,q.dmOp),c(e,d.get,"get"),c(e,d.set,"set"),b(e),o.applyPolicy(e,e._Flow,d),this.init(d)},init:function(){},get:function(a){var b=this;return a=d(b,a),f(b._Flow.boot(b,b.op,a.policy),a.success,a.error)},set:function(a){var b=this;return a=d(b,a),f(b._Flow.bootWithStart("setData",[b,b.op,a.policy]),a.success,a.error)},_innerSearch:function(){},_innerUpdate:function(){},checkEmpty:function(a){return void 0===a},validate:function(){},clear:function(){},setDataSerive:function(){},initPolicy:function(b){this._filterMode&&(b._filterBuilder=b.filter?a.filterBuilder(b.filter):r)},buildParams:function(a,b){g(this,a,b)},buildPolicy:function(b,c){this.buildParams(b,c),a.mergeObj(b,c,q.ignoreMerges)}}}),o=a.factory({name:"DataPolicyManager",type:"copy",proto:{applyPolicy:function(a,b,c){this.fire("init",[a,b,c])}},base:{init:function(){}}}),o.add("getWay",{init:function(a,b){b.onBefore("getData","checkGetWay",function(a,b,c,d){var e,f=d.way;f&&("ds"===f?e="getFromDs":"dm"===f&&(e="getFromDm"),e&&a.next(e).stop())})}}),o.add("trigger",{init:function(a,b,c){var d=c.get&&c.get.trigger;d&&($.each(d,function(d,e){m(d,e,a,b,c)}),c.get.trigger=null)}}),{dataManager:n,dataPolicyManager:o,dataServices:p}}),stDefine("dataManager-table",function(a){function b(a){return q(a)?!0:void console.log("存储的数据不正确！")}function c(a,b,c,d){var e=a.op.crud[b];return c||(c={}),e&&a.buildPolicy(c,e),d||null!=c.updateType||(c.updateType=b),c}function d(a,b){var c,d=b.pageInf,f=a.pageInf;b.update&&!b.updateType&&(b.updateType="find"),b.way||(c=d&&e(d,f,["page","pageSize"])?!0:e(b,a,["order","group"]),c&&(b.way="ds"))}function e(a,b,c){var d,e;return c.some(function(c){return value1=a[c],null!=d&&d==b[c]?(e=!0,!0):void 0}),e}function f(a,b){var c,d,e,f;b&&null!=(c=b.params)&&(f=typeof c,"function"!==f&&"object"!==f&&(d=a.getKey())&&(e=c,b.params=c={},c[d]=e))}function g(a,b,c,d){var e,f=d.data;f&&(e=f[c.getField.pageInf])&&($.extend(c.pageInf,e),d.data=f[c.getField.result])}function h(a,b){a.store(b||[])}function i(a,b){var c=a.$store;q(b)?a.$store=c.concat(b):c.push(b)}function j(a,b,c,d){var e;return a.forEach(function(f,g){return c(f,g)?(d?a[g]=b:$.extend(f,b),e=!0,!1):void 0}),e}function k(a,b,c,d,e){var f,g=a.$store;return g.length&&c.filter&&(f=j(g,b,c.filter,d)),e&&f||i(a,[b]),!0}function l(a,b,c,d,e){var f,g=a.$store,h=a.getKey(),k=0;return g.length&&h?b.forEach(function(b){f=b[h],j(g,b,function(a){return a[h]===f},d)?k++:e&&(k++,i(a,b))}):e&&(i(a,b),k=b.length),k}function m(a,b){var c=a.$store,d=[];return 0===c.length?d:b&&b.filter?(n(c,b,function(a){d.push(a)},!0),d):d.concat(c)}function n(b,c,d,e){var f,g,h,i,j=0,k=b.length;if(0!==k){if(c){if(f=c.filter,!f&&e)return;g=c.pageInf,g&&g.page&&(a.mergeObj(pageinf,s.pageInf),j=(g.page-1)*g.pageSize,j+g.pageSize>k&&(k=j+g.pageSize))}if(f)for(;k>j;j++)i=b[j],f(i,j,b)&&(h=d(i,j,b),null!=h&&(j=h));else for(;k>j;j++)h=d(i,j,b),null!=h&&(j=h)}}function o(a,b){var c,d,e=a.$store,f=0,g=e.length;if(0!==g)return b&&(c=b.filter)?(d=b.preDelete?function(a){p(a,r[3],!0)}:function(a,b){return e.splice(b,1),f++,--b},n(e,b,d,!0)):a.$store=[],f}function p(a,b,c){a[b]=c}var q=$.isArray,r=($.isPlainObject,["_$new","_$selected","_$updated","_$deleted"]),s={pageInf:{pageSize:20,groupSize:20,page:1,total:0},getField:{pageInf:"pageInf",result:"result"}};a.dataManager.add("DataTable",{init:function(b){var c=this;a.mergeObj(!0,b,s),c.$store=[],b.crud?c.crud.forEach(function(a,b){c.initPolicy(b),b.set&&c.initPolicy(b.set)}):b.crud={},c._Flow.onBefore("setData","handleResult",g)},getKey:function(){return this.op.key},checkEmpty:function(a){return null==a||0===a.length},clear:function(){this.$store=[]},_innerUpdate:function(a){if(a){{var b="replace"===a.updateMode,c=a.updateType,d=(a.filter,this),e=a.data;d.$store,!q(e)}return"find"===c?h(d,e):"insert"===c?i(d,e):"delete"===c?o(d,a):(q(e)?l:k)(d,e,a,b,"save"===c),e}},store:function(a){b(a)&&(this.$store=a)},updateOne:function(a){return a?(f(this,a),this.update(a)):void 0},update:function(a){return c(this,"update",a),this.set(a)},insert:function(a){return c(this,"insert",a),this.set(a)},save:function(a){return c(this,"save",a),this.set(a)},_innerSearch:function(a){return m(this,a)},findOne:function(a){var b;return a?(f(this,a),b=a.success):a={},b&&(a.success=function(a){b(a&&a[0])}),this.find(c(this,"findOne",a,!0))},find:function(a){return c(this,"find",a,!0),d(this.op,a),this.get(a)},removeOne:function(a){return a?(f(this,a),this.remove(a)):void 0},remove:function(a){return this.update(c(this,"remove",a))},findWithStates:function(a){var b=[];return a.forEach(function(a){result[a]=[]}),b=function(b){a.some(function(a){return b[a]?(result[a].push(b),!0):void 0})},result},findByState:function(){},setDataSerive:function(){}})});